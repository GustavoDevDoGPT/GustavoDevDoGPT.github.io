<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detalhes do Im√≥vel | Gisele Brand√£o Im√≥veis</title>

  <!-- Estilos modernos com Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm"

    const supabaseUrl = "https://xgknxgixeoptrgniiwiq.supabase.co"     // üîπ troque pelo seu
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhna254Z2l4ZW9wdHJnbmlpd2lxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3MzIwOTksImV4cCI6MjA3NjMwODA5OX0.NeJ8_ezbWEpqJzYxxZ6fZtOWrOt0rbmooWosCvxmoeI"                      // üîπ troque pela sua anon key
    const supabase = createClient(supabaseUrl, supabaseKey)

    async function carregarDetalhes() {
      const params = new URLSearchParams(window.location.search)
      const id = params.get("id")

      const conteudo = document.getElementById("conteudo")

      if (!id) {
        conteudo.innerHTML = `<p class="text-center text-red-500 text-lg">Im√≥vel n√£o encontrado.</p>`
        return
      }

      const { data: imovel, error } = await supabase
        .from("imoveis")
        .select("*")
        .eq("id", id)
        .single()

      if (error || !imovel) {
        console.error(error)
        conteudo.innerHTML = `<p class="text-center text-red-500 text-lg">Erro ao carregar o im√≥vel.</p>`
        return
      }

      // formata pre√ßo
      const precoFormatado = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(imovel.preco)

      // monta o HTML
      conteudo.innerHTML = `
        <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden mt-10">
          <img src="${imovel.imagem_url}" alt="${imovel.titulo}" class="w-full h-80 object-cover" />
          <div class="p-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-3">${imovel.titulo}</h1>
            <p class="text-gray-600 mb-4">${imovel.descricao || "Sem descri√ß√£o dispon√≠vel."}</p>
            
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-gray-700 mb-6">
              <p><strong>Pre√ßo:</strong><br>${precoFormatado}</p>
              <p><strong>Localiza√ß√£o:</strong><br>${imovel.localizacao || "N√£o informada"}</p>
              <p><strong>Metragem:</strong><br>${imovel.metragem || "‚Äî"} m¬≤</p>
              <p><strong>Dormit√≥rios:</strong><br>${imovel.quartos || "‚Äî"}</p>
              <p><strong>Banheiros:</strong><br>${imovel.banheiros || "‚Äî"}</p>
              <p><strong>Condom√≠nio:</strong><br>${imovel.condominio || "‚Äî"}</p>
            </div>

            <div class="flex flex-col sm:flex-row gap-3">
              <a href="index.html" class="px-5 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-center">‚Üê Voltar</a>
              <a href="https://wa.me/5511943609158?text=Ol√°! Tenho interesse no im√≥vel '${encodeURIComponent(imovel.titulo)}'." target="_blank" class="px-5 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 text-center flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 13.75a8.25 8.25 0 01-8.25 8.25 8.212 8.212 0 01-4.03-1.07L3.75 21.75l.82-3.29A8.25 8.25 0 1115 3.75a8.25 8.25 0 015.25 10z" />
                </svg>
                Falar no WhatsApp
              </a>
            </div>
          </div>
        </div>
      `
    }

    carregarDetalhes()
  </script>
</head>
<body class="bg-gray-100 font-sans">
  <div id="conteudo" class="p-4"></div>
</body>
</html>
